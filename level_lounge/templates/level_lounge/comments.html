<div class="comment mb-3">
    {% if comment.parent %}
    <!-- Display 'Replying to' with the user of the parent comment -->
    <p><em>Replying to {{ comment.parent.user }}</em></p>
    {% endif %}


    <p><strong>{{ comment.user }}</strong> - {{ comment.created_at }}</p>
    <p>{{ comment.content }}</p>

    <!-- Check if there are replies before including the replies recursively -->
    {% if comment.replies.exists %}
    <div class="replies ml-3">
        <!-- Recursively include comments for replies -->
        {% for reply in comment.replies.all %}
        {% include 'level_lounge/comments.html' with comment=reply %}
        {% endfor %}
    </div>
    {% endif %}

    <!-- Reply Form for Each Comment -->
    {% if user.is_authenticated %}
    <button class="btn btn-secondary btn-sm" type="button" onclick="toggleReplyForm('{{ comment.id }}')"></button>
    Reply
    </button>

    <!-- Reply Form for Each Comment (initially hidden) -->
    <div id="reply-form-{{ comment.id }}" style="display: none; margin-top: 10px;">
        <form method="post" action="{% url 'post_detail' post.slug %}">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <input type="hidden" name="parent" value="{{ comment.id }}">
            <button type="submit" class="btn btn-primary">Submit Reply</button>
        </form>
    </div>
    {% endif %}
</div>